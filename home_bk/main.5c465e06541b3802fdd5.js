(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{0:function(t,e,r){t.exports=r("zUnb")},AytR:function(t,e,r){"use strict";r.d(e,"a",function(){return o});const o={production:!0,host:"https://core.zeroonlinevn.com/api/"}},IYfF:function(t,e,r){"use strict";r.d(e,"a",function(){return s});var o=r("fXoL"),n=r("tk/3");let s=(()=>{class t{constructor(t){this.http=t}SignIn(t){return this.http.post("auth/login",t)}RefreshToken(){return this.http.post("auth/refreshToken",{refreshToken:localStorage.getItem("refreshToken")})}Register(t){return this.http.post("auth/register",t)}Logout(){return this.http.post("auth/logout",{})}ResetPassword(t){return this.http.post("auth/resetPassword",t)}}return t.\u0275fac=function(e){return new(e||t)(o.Qb(n.b))},t.\u0275prov=o.Db({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()},QLLi:function(t,e,r){"use strict";r.d(e,"a",function(){return s});var o=r("fXoL"),n=r("5eHb");let s=(()=>{class t{constructor(t){this.toastr=t}error(t,e=""){this.toastr.error(t,e)}success(t="Th\xe0nh c\xf4ng",e=""){this.toastr.success(t,e)}}return t.\u0275fac=function(e){return new(e||t)(o.Qb(n.b))},t.\u0275prov=o.Db({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()},XhJ5:function(t,e,r){"use strict";r.d(e,"a",function(){return o});const o={auth:{login:"/auth/login",forgotPassword:"/auth/forgot-password",completeRequest:"/auth/complete",refreshToken:"/auth/refreshToken",register:"/auth/register"},card:{napThe:"/nap-the",history:"/nap-the/lich-su",ATM:"/nap-the/atm"},error:{_404:"/error/404",_403:"/error/page403"}}},kiQV:function(t){t.exports=JSON.parse('{"a":"1.5.0"}')},zUnb:function(t,e,r){"use strict";r.r(e);var o=r("fXoL"),n=r("AytR"),s=r("jhN1"),a=r("tyNb"),i=r("XhJ5");let c=(()=>{class t{constructor(t){this.router=t}canActivate(t,e){return!!localStorage.getItem("token")||(this.router.navigate([i.a.auth.login]).then(),!1)}canActivateChild(t,e){return console.log("canActivateChild"),!0}}return t.\u0275fac=function(e){return new(e||t)(o.Qb(a.a))},t.\u0275prov=o.Db({token:t,factory:t.\u0275fac}),t})();const u=[{path:"auth",loadChildren:()=>r.e(13).then(r.bind(null,"x5k8")).then(t=>t.NonLoginModule)},{path:"",canActivate:[c],loadChildren:()=>r.e(6).then(r.bind(null,"IqHI")).then(t=>t.InLoginModule)}];let h=(()=>{class t{}return t.\u0275mod=o.Fb({type:t}),t.\u0275inj=o.Eb({factory:function(e){return new(e||t)},imports:[[a.c.forRoot(u)],a.c]}),t})();var l=r("kiQV");let f=(()=>{class t{constructor(){this.title="id",this.css=[]}addCss(t,e){if(!t)return;const r=document.createElement("link");r.rel="stylesheet",r.href=t+"?version="+l.a,document.head.append(r),this.addCss(e.shift(),e)}ngAfterViewInit(){console.info("App version",l.a),this.addCss(this.css.shift(),this.css)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=o.Bb({type:t,selectors:[["app-root"]],decls:1,vars:0,template:function(t,e){1&t&&o.Ib(0,"router-outlet")},directives:[a.d],styles:[""]}),t})();var d=r("tk/3"),p=r("JIr8"),g=r("nYR2"),b=r("eIep"),v=r("z6cu");const k="We tried to connect to the server but it failed";var w=r("QLLi"),m=r("IYfF"),y=r("2Vo4");let I=(()=>{class t{constructor(){this.isLoading=new y.a(!1)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=o.Db({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),L=(()=>{class t{constructor(t,e,r,o){this.router=t,this.toastr=e,this.authService=r,this.loaderService=o}intercept(e,r){t.counter+=1,1===t.counter&&this.loaderService.isLoading.next(!0);const o=localStorage.getItem("token");let s=e.clone({url:n.a.host+e.url});return o&&(s=s.clone({setHeaders:{Authorization:"Bearer "+o}})),r.handle(s).pipe(Object(p.a)(t=>{switch(t.status){case 0:this.toastr.error(k);break;case 400:this.toastr.error(t.error&&t.error.message||k);break;case 401:if(t.url.toLowerCase().endsWith("refreshtoken")){localStorage.clear(),this.router.navigate([i.a.auth.login]).then();break}return this.refreshTokenAndRetry(s,r);case 404:this.router.navigate([i.a.error._404]).then();break;case 403:this.router.navigate([i.a.error._403]).then();break;default:this.toastr.error(t.error&&t.error.message||t.message)}return Object(v.a)(t)}),Object(g.a)(()=>{t.counter-=1,0===t.counter&&this.loaderService.isLoading.next(!1)}))}refreshTokenAndRetry(t,e){return this.authService.RefreshToken().pipe(Object(b.a)(r=>(localStorage.setItem("token",r.token),e.handle(this.mappingToken(t)))),Object(p.a)(r=>{if(401===r.status){if(!r.url.toLowerCase().endsWith("refreshtoken"))return this.refreshTokenAndRetry(t,e);localStorage.clear(),this.router.navigate([i.a.auth.login]).then()}throw r}))}mappingToken(t){const e=localStorage.getItem("token");return t.clone({setHeaders:{Authorization:"Bearer "+e}})}}return t.counter=0,t.\u0275fac=function(e){return new(e||t)(o.Qb(a.a),o.Qb(w.a),o.Qb(m.a),o.Qb(I))},t.\u0275prov=o.Db({token:t,factory:t.\u0275fac}),t})();var T=r("3Pt+"),R=r("R1ws"),A=r("5eHb");let S=(()=>{class t{}return t.\u0275mod=o.Fb({type:t,bootstrap:[f]}),t.\u0275inj=o.Eb({factory:function(e){return new(e||t)},providers:[c,{provide:d.a,useClass:L,multi:!0}],imports:[[s.a,h,d.c,T.b,R.a,A.a.forRoot()]]}),t})();n.a.production&&Object(o.R)(),s.c().bootstrapModule(S).catch(t=>console.error(t))},zn8P:function(t,e){function r(t){return Promise.resolve().then(function(){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e})}r.keys=function(){return[]},r.resolve=r,t.exports=r,r.id="zn8P"}},[[0,1,5]]]);